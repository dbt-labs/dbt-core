# dbt debug

## Overview

`dbt debug` validates the data warehouse connection by checking profile.yml configuration files, testing the database connection, and reporting dependency versions. It's the first troubleshooting command when dbt isn't working correctly.

**Reference**: https://docs.getdbt.com/reference/commands/debug

## Task Class: `DebugTask`

`DebugTask` extends `BaseTask` and performs a series of validation checks:

`DebugTask` performs the following checks in order:

1. Print version info (dbt, Python, OS)
2. Load and validate `profiles.yml`
3. Load and validate `dbt_project.yml`
4. Test required dependencies (e.g., git)
5. Test database connection

## Implementation Quirks

### Minimal Context Requirements

`dbt debug` uses minimal `@requires`. decorator as it doesn't require a loaded manifest, profile, or project to start. Only `@requires.preflight` and `@requires.postflight` are used.

### Graceful Failure Handling

Unlike other commands, `debug` continues checking even when individual steps fail. Each check returns a `SubtaskStatus` with success/failure status and details, allowing the full diagnostic report to be generated.

### `--config-dir` Flag

Opens the profiles directory in the system file manager using the OS-appropriate command.

### `--connection` Flag

Skips configuration validation (profiles.yml, dbt_project.yml, dependencies) and jumps straight to connection testing.

### Multiple Profile Handling

If no `dbt_project.yml` exists, debug lists available profiles from `profiles.yml` and prompts the user to specify one with `--profile`.

### Adapter Version Detection

Debug dynamically imports adapter packages (e.g., `dbt.adapters.postgres.__version__`) to report installed versions. Returns "unknown" if the adapter module can't be found.

## Checks Performed

| Check | Description |
|-------|-------------|
| dbt version | Installed dbt-core version |
| python version | Python interpreter version |
| python path | Path to Python executable |
| os info | Operating system details |
| profiles.yml | Profile file exists and is valid YAML |
| dbt_project.yml | Project file exists and is valid |
| adapter type | Which adapter is configured |
| adapter version | Installed adapter package version |
| Connection | Test database connectivity |

## Flags

| Flag | Description |
|------|-------------|
| `--config-dir` | Open profiles directory in file manager |
| `--connection` | Skip to connection test only |

## Output Example

```
dbt version: 1.7.0
python version: 3.10.12
python path: /usr/bin/python3
os info: Linux-5.15.0-x86_64

Using profiles dir at /home/user/.dbt
Using profiles.yml file at /home/user/.dbt/profiles.yml
Using dbt_project.yml file at /home/user/project/dbt_project.yml

Configuration:
  profiles.yml file [OK found and valid]
  dbt_project.yml file [OK found and valid]

Required dependencies:
  - git [OK found]

Connection:
  adapter: postgres
  connection_info: host=localhost port=5432 user=analyst
  Connection test: [OK connection ok]
```
